<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechTinker Authentication</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <style>
        /* Custom Tailwind Configuration */
        :root {
            --primary-color: #3b82f6; /* Tailwind blue-500 */
            --secondary-color: #1f2937; /* Tailwind gray-800 */
            --background-color: #f3f4f6; /* Tailwind gray-100 */
            --card-bg: #ffffff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
        }

        /* Modal specific styles */
        .signin-modal {
            display: none; /* Controlled by JS */
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .signin-content {
            background-color: var(--card-bg);
            margin: 5% auto; /* 5% from the top and centered */
            padding: 24px 32px;
            border-radius: 1rem;
            width: 90%;
            max-width: 440px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            position: relative;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            color: var(--secondary-color);
            position: absolute;
            top: 12px;
            right: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.2s;
        }

        .close:hover,
        .close:focus {
            color: var(--primary-color);
            text-decoration: none;
        }

        /* Form and element styling */
        .login-header {
            text-align: center;
            margin-bottom: 24px;
        }

        .logo-placeholder {
            font-size: 40px;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .login-header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--secondary-color);
        }

        .login-header p {
            font-size: 1rem;
            color: #6b7280; /* Tailwind gray-500 */
            margin-top: 4px;
        }

        .input-group {
            position: relative;
            margin-bottom: 0px; /* Reduced margin here, moved spacing to the error/input line */
        }

        .input-group .icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af; /* Tailwind gray-400 */
            font-size: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 12px 12px 12px 40px; /* Padding for icon */
            border: 1px solid #d1d5db; /* Tailwind gray-300 */
            border-radius: 0.5rem;
            transition: border-color 0.2s, box-shadow 0.2s;
            outline: none;
        }

        .input-group input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
        }

        .password-group .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
            cursor: pointer;
            transition: color 0.2s;
        }

        .password-group .toggle-password:hover {
            color: var(--primary-color);
        }

        .error-message {
            color: #ef4444; /* Tailwind red-500 */
            font-size: 0.75rem; /* text-xs */
            margin-top: 4px;
            margin-bottom: 12px; /* Spacing between input groups */
            margin-left: 4px;
            height: 18px; /* Maintain layout when hidden */
        }

        .actions-row {
            display: flex;
            justify-content: flex-end;
            margin-top: -8px; /* Move closer to the password field */
            margin-bottom: 16px;
        }

        .forgot-password {
            font-size: 0.875rem;
            color: var(--primary-color);
            text-decoration: none;
            transition: opacity 0.2s;
        }

        .forgot-password:hover {
            opacity: 0.8;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            border-radius: 0.5rem;
            transition: background-color 0.2s, transform 0.1s;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 6px rgba(59, 130, 246, 0.2);
        }

        .login-btn:hover {
            background-color: #2563eb; /* Tailwind blue-600 */
        }

        .login-btn:active {
            transform: scale(0.99);
        }

        .create-account-link {
            text-align: center;
            margin-top: 16px;
            font-size: 0.875rem;
            color: #6b7280;
        }

        .create-account-link a {
            color: var(--primary-color);
            font-weight: 600;
            text-decoration: none;
            transition: opacity 0.2s;
        }

        .create-account-link a:hover {
            opacity: 0.8;
        }

        .separator {
            display: flex;
            align-items: center;
            text-align: center;
            margin: 24px 0;
            color: #9ca3af;
            font-size: 0.875rem;
        }

        .separator::before,
        .separator::after {
            content: '';
            flex: 1;
            border-bottom: 1px solid #e5e7eb;
        }

        .separator:not(:empty)::before {
            margin-right: 1rem;
        }

        .separator:not(:empty)::after {
            margin-left: 1rem;
        }

        .google-login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 12px;
            background-color: white;
            color: var(--secondary-color);
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            font-weight: 500;
            transition: background-color 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .google-login-btn:hover {
            background-color: #f3f4f6;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .google-login-btn .fab {
            margin-right: 8px;
            font-size: 1.25rem;
        }
        

        
        .checkbox-container input {
            position: absolute;
            opacity: 0;
            cursor: pointer;
            height: 0;
            width: 0;
        }
        
        .checkmark {
            position: absolute;
            top: 0;
            left: 0;
            height: 18px;
            width: 18px;
            background-color: #eee;
            border-radius: 4px;
            border: 1px solid #d1d5db;
        }
        
        .checkbox-container:hover input ~ .checkmark {
            background-color: #ccc;
        }
        
        .checkbox-container input:checked ~ .checkmark {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .checkmark:after {
            content: "";
            position: absolute;
            display: none;
        }
        
        .checkbox-container input:checked ~ .checkmark:after {
            display: block;
        }
        
        .checkbox-container .checkmark:after {
            left: 5px;
            top: 1px;
            width: 5px;
            height: 10px;
            border: solid white;
            border-width: 0 3px 3px 0;
            -webkit-transform: rotate(45deg);
            -ms-transform: rotate(45deg);
            transform: rotate(45deg);
        }

        /* Loading Spinner Overlays */
        .authLoading {
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body class="p-8">

    <!-- Primary Button to open the Modal -->
    <div class="flex items-center justify-center h-screen">
        <button id="openSignInModalBtn" class="px-6 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-xl hover:bg-blue-700 transition duration-300">
            Open Sign In
        </button>
    </div>

    <!-- MESSAGE BOX (Replaces alert() and confirm()) -->
    <div id="messageBox" class="fixed inset-0 bg-black bg-opacity-50 z-[1100] hidden items-center justify-center">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full">
            <h3 id="messageTitle" class="text-xl font-bold mb-3 text-gray-800"></h3>
            <p id="messageText" class="text-gray-600 mb-6"></p>
            <div class="flex justify-end">
                <button id="messageCloseBtn" class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition">OK</button>
            </div>
        </div>
    </div>
    
    <!-- SIGN-IN MODAL -->
    <div id="signinPage" class="signin-modal">
        <div class="signin-content">
            <span id="closeIcon" class="close" data-target="signinPage">&times;</span>

            <!-- Header -->
            <div class="login-header">
                <div class="logo-placeholder">
                    <i class="fas fa-ghost"></i>
                </div>
                <h1>TechTinker</h1>
                <p>Login to your account</p>
            </div>

            <!-- Login Form -->
            <form id="emailLoginForm" class="login-form" novalidate>
                
                <div class="input-group">
                    <i class="fas fa-envelope icon"></i>
                    <input type="email" id="loginEmail" placeholder="Enter your Email" required>
                </div>
                <p id="loginEmailError" class="error-message"></p>

                <div class="input-group password-group">
                    <i class="fas fa-lock icon"></i>
                    <input type="password" id="loginPassword" placeholder="Password" required>
                    <i class="fas fa-eye-slash toggle-password" data-target-id="loginPassword"></i>
                </div>
                <p id="loginPasswordError" class="error-message"></p>


                <div class="actions-row">
                    <!-- Note: Real Firebase app would handle 'Forgot Password' flow -->
                    <a href="#" class="forgot-password">Forgot Password?</a>
                </div>

                <button type="submit" class="login-btn">Login</button>
            </form>

            <!-- Create account link -->
            <div class="create-account-link">
                Not a member? 
                <a href="#" id="registerLink" data-show="createAccountModal" data-hide="signinPage">Create New Account</a>
            </div>

            <!-- Separator -->
            <div class="separator">Or continue with</div>

            <!-- Google Sign-In -->
            <button type="button" class="googleSignInBtn google-login-btn">
                <i class="fab fa-google"></i> Continue with Google
            </button>

            <!-- Loading Spinner -->
            <div id="loginLoading" class="authLoading absolute inset-0 bg-white/70 flex items-center justify-center rounded-lg hidden">
                <div class="animate-spin rounded-full h-10 w-10 border-t-4 border-blue-500 border-solid"></div>
            </div>
        </div>
    </div>

    <!-- CREATE ACCOUNT MODAL -->
    <div id="createAccountModal" class="signin-modal">
        <div class="signin-content">
            <span id="closeCreateAccount" class="close" data-target="createAccountModal">&times;</span>

            <!-- Header -->
            <div class="login-header">
                <div class="logo-placeholder">
                    <i class="fas fa-ghost"></i>
                </div>
                <h1>TechTinker</h1>
                <p>Create your account</p>
            </div>

            <!-- Create Account Form -->
            <form id="createAccountForm" class="login-form" novalidate>
                <div class="input-group">
                    <i class="fas fa-user icon"></i>
                    <input type="text" id="newUserName" placeholder="Full Name" required>
                </div>
                <p id="newUserNameError" class="error-message"></p>

                <div class="input-group">
                    <i class="fas fa-envelope icon"></i>
                    <input type="email" id="newUserEmail" placeholder="Email" required>
                </div>
                <p id="newUserEmailError" class="error-message"></p>

                <div class="input-group password-group">
                    <i class="fas fa-lock icon"></i>
                    <input type="password" id="newUserPassword" placeholder="Password (Min 8 characters)" required>
                    <i class="fas fa-eye-slash toggle-password" data-target-id="newUserPassword"></i>
                </div>
                <p id="newUserPasswordError" class="error-message"></p>

                <div class="actions-row">
                    <!-- Checkbox removed to avoid confusion with the eye icon, kept checkbox styling for reference -->
                </div>

                <button type="submit" class="login-btn">Create Account</button>
            </form>

            <p class="create-account-link" style="margin-top: 12px; font-size: 14px;">
                Already have an account?
                <a href="#" id="backToSignIn" data-show="signinPage" data-hide="createAccountModal">Sign In</a>
            </p>

            <!-- Separator -->
            <div class="separator">Or continue with</div>

            <!-- Google Sign-In -->
            <button type="button" class="googleSignInBtn google-login-btn">
                <i class="fab fa-google"></i> Continue with Google
            </button>
            
            <!-- Loading Spinner -->
            <div id="registerLoading" class="authLoading absolute inset-0 bg-white/70 flex items-center justify-center rounded-lg hidden">
                <div class="animate-spin rounded-full h-10 w-10 border-t-4 border-blue-500 border-solid"></div>
            </div>
        </div>
    </div>


    <script>
        // --- Utility Functions ---

        /**
         * Custom replacement for alert() and confirm()
         * @param {string} title - Title of the message box.
         * @param {string} message - Content of the message.
         */
        const showMessageBox = (title, message) => {
            const messageBox = document.getElementById('messageBox');
            document.getElementById('messageTitle').textContent = title;
            document.getElementById('messageText').textContent = message;
            messageBox.style.display = 'flex';
        };

        const hideMessageBox = () => {
            document.getElementById('messageBox').style.display = 'none';
        };

        document.getElementById('messageCloseBtn').addEventListener('click', hideMessageBox);
        
        // --- Modal/View Switching Logic ---

        /**
         * Shows one modal and hides another using data attributes.
         * @param {Event} e 
         */
        const handleModalToggle = (e) => {
            e.preventDefault();
            const target = e.currentTarget;
            const showId = target.getAttribute('data-show');
            const hideId = target.getAttribute('data-hide');

            if (showId) {
                document.getElementById(showId).style.display = 'flex';
            }
            if (hideId) {
                document.getElementById(hideId).style.display = 'none';
            }
        };

        /**
         * Closes a modal when the close icon is clicked.
         * @param {Event} e 
         */
        const handleModalClose = (e) => {
            const targetId = e.currentTarget.getAttribute('data-target');
            document.getElementById(targetId).style.display = 'none';
        };

        // Event listener to open the sign-in modal
        document.getElementById('openSignInModalBtn').addEventListener('click', () => {
            document.getElementById('signinPage').style.display = 'flex';
        });

        // Attach listeners for closing and switching
        document.querySelectorAll('[data-target]').forEach(el => {
            el.addEventListener('click', handleModalClose);
        });

        document.querySelectorAll('[data-show]').forEach(el => {
            el.addEventListener('click', handleModalToggle);
        });

        // Close modal when clicking outside (on the overlay)
        document.querySelectorAll('.signin-modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });
        });

        // --- Password Visibility Toggle Logic ---

        /**
         * Toggles the visibility of a password field.
         * @param {Event} e 
         */
        const handlePasswordToggle = (e) => {
            const icon = e.currentTarget;
            const inputId = icon.getAttribute('data-target-id');
            const passwordInput = document.getElementById(inputId);

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            } else {
                passwordInput.type = 'password';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            }
        };

        document.querySelectorAll('.toggle-password').forEach(icon => {
            icon.addEventListener('click', handlePasswordToggle);
        });
        
        // --- Form Validation and Submission Handlers ---

        /**
         * Sets an error message below an input field.
         * @param {string} inputId - The ID of the input element (e.g., 'loginEmail').
         * @param {string} message - The error message to display.
         */
        const setError = (inputId, message) => {
            const errorElement = document.getElementById(inputId + 'Error');
            const inputElement = document.getElementById(inputId);
            
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.classList.remove('hidden');
            }
            if (inputElement) {
                // Add a visual indicator like a red border if needed
                inputElement.style.borderColor = message ? '#ef4444' : '#d1d5db';
            }
        };

        /**
         * Clears the error message for an input field.
         * @param {string} inputId - The ID of the input element.
         */
        const clearError = (inputId) => {
            setError(inputId, '');
            document.getElementById(inputId + 'Error')?.classList.add('hidden');
        };

        /**
         * Toggles the loading state overlay.
         * @param {string} overlayId - The ID of the loading overlay element (e.g., 'loginLoading').
         * @param {boolean} show - Whether to show or hide the overlay.
         */
        const toggleLoading = (overlayId, show) => {
            const overlay = document.getElementById(overlayId);
            if (overlay) {
                overlay.classList.toggle('hidden', !show);
            }
        };

        // --- Sign In Form Submission ---
        document.getElementById('emailLoginForm').addEventListener('submit', (e) => {
            e.preventDefault();
            
            // Clear previous errors
            clearError('loginEmail');
            clearError('loginPassword');

            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;

            let isValid = true;

            if (!email) {
                setError('loginEmail', 'Email is required.');
                isValid = false;
            } else if (!email.includes('@') || !email.includes('.')) {
                setError('loginEmail', 'Please enter a valid email address.');
                isValid = false;
            }

            if (!password) {
                setError('loginPassword', 'Password is required.');
                isValid = false;
            }

            if (isValid) {
                toggleLoading('loginLoading', true);
                
                // --- Placeholder for Firebase Email/Password Sign-In ---
                setTimeout(() => {
                    toggleLoading('loginLoading', false);

                    // SIMULATION: Check for simulated wrong password
                    if (password === 'wrongpass') {
                        setError('loginPassword', 'The password you entered is incorrect. Please try again.');
                        console.log('SIMULATION: Login failed - Wrong password.');
                        return; // Stop the successful demo message
                    }

                    showMessageBox('Login Success (Demo)', `Attempting to sign in with email: ${email}`);
                    // In a real app, call Firebase signInWithEmailAndPassword here.
                    // If successful, hide the modal: document.getElementById('signinPage').style.display = 'none';
                    // If error: setError('loginPassword', 'Invalid credentials or account not found.');
                }, 1500);
            }
        });

        // --- Create Account Form Submission ---
        document.getElementById('createAccountForm').addEventListener('submit', (e) => {
            e.preventDefault();

            // Clear previous errors
            clearError('newUserName');
            clearError('newUserEmail');
            clearError('newUserPassword');

            const name = document.getElementById('newUserName').value.trim();
            const email = document.getElementById('newUserEmail').value.trim();
            const password = document.getElementById('newUserPassword').value;

            let isValid = true;

            if (!name) {
                setError('newUserName', 'Full name is required.');
                isValid = false;
            }

            if (!email || (!email.includes('@') || !email.includes('.'))) {
                setError('newUserEmail', 'Please enter a valid email address.');
                isValid = false;
            }
            
            if (!password || password.length < 8) {
                setError('newUserPassword', 'Password must be at least 8 characters.');
                isValid = false;
            }

            if (isValid) {
                toggleLoading('registerLoading', true);

                // --- Placeholder for Firebase Email/Password Registration ---
                setTimeout(() => {
                    toggleLoading('registerLoading', false);
                    showMessageBox('Registration Success (Demo)', `Account created for ${name}. Email: ${email}`);
                    // In a real app, call Firebase createUserWithEmailAndPassword here, 
                    // then update profile (displayName).
                    // If successful, hide the modal: document.getElementById('createAccountModal').style.display = 'none';
                    // If error: setError('newUserEmail', 'Email address is already in use.');
                }, 1500);
            }
        });

        // --- Google Sign-In Placeholder ---
        document.querySelectorAll('.googleSignInBtn').forEach(btn => {
            btn.addEventListener('click', () => {
                const isLogin = btn.closest('#signinPage');
                const loadingId = isLogin ? 'loginLoading' : 'registerLoading';
                toggleLoading(loadingId, true);

                setTimeout(() => {
                    toggleLoading(loadingId, false);
                    showMessageBox('Google Sign-In (Demo)', 'Initiating Google Authentication flow...');
                    // In a real app, call Firebase signInWithPopup(provider) here.
                }, 1500);
            });
        });

    </script>
</body>
</html>
